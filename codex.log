# codex 作業ログ

## 1. リポジトリ初期化と足場構築
- AGENTS.md の仕様をもとに `package.json`、`tsconfig.json`、`src/`、`web/`、`lessons/`、`templates/`、`scripts/` などの基本構成を準備。
- TypeScript で CLI/サーバ/ウォッチャ/教材メタ情報/共通型を実装し、Mermaid プレビュー用のフロントエンド (index.html / styles.css / client.js) を構築。
- 12 トピック分の教材 Markdown と Mermaid テンプレートを作成。
- `scripts/prepare-vendor.mjs` と `scripts/highlight-entry.mjs` を追加し、mermaid / marked / DOMPurify / highlight.js をローカル配布できるよう整備 (highlight.js は esbuild でバンドル)。
- 依存関係をインストール (`npm install`) し、`npm run build` で TypeScript ビルドを確認。

## 2. 機能追加・改善
- web/client.js で改行コードを正規化し、Quadrant Chart の Lexical error を解消。
- 教材表示のタイポグラフィとダークテーマの配色を調整。
- レッスン／エディタ／プレビューのリサイズが可能なドラッグハンドルを実装し、キーボード操作にも対応。
- プレビューをクリックまたは Enter/Space で拡大できるモーダルを追加し、ESC・背景クリックでも閉じられるように設定。
- HEader を含むダークテーマの配色を再設計して視認性を改善。
- トピック名とラベルを日本語化（`src/lessons.ts` と `web/index.html`）。
- README をブラウザ中心のワークフローに刷新。

## 3. ツール・オートメーションまわり
- `.gitignore` を拡張し、OS／エディタ／ログ／キャッシュ系ファイルを除外しつつ `codex.log` は追跡対象に設定。
- モーダルのアクセシビリティ（フォーカス制御、ESC、ボディスクロール抑制）とプレビューの有効/無効状態管理を client.js で整備。

## 4. Git 操作履歴
- `git init` → `main` ブランチへリネーム → `origin https://github.com/hiroki-imai/mmtutor.git` を追加。
- 初回コミット `feat: bootstrap mmtutor MVP` を作成し、`git push -u origin main` でリモート公開。
- README 更新を `docs: refresh README for browser workflow` としてコミットし、リモート反映。
- 作業記録 `codex.log` を追加し、`.gitignore` 更新とともに `docs: add codex session log` をコミット＆プッシュ。

## 5. 現在の状態
- `git status` で作業ツリーはクリーン。
- 最新ビルドは `npm run build` で成功。
- リモート `origin/main` には最新コミット (`docs: add codex session log`) まで反映済み。

## 6. ユーザープロンプト履歴
1. mmtutor（MVP・Webプレビューのみ）仕様書（AGENTS.md 相当）の提示。
2. 「AGENTS.md の内容を実装してください。」
3. 「教材テキストのフォントが読みにくい。見出し・コードブロックなどマークダウンのような表示にして視覚的にわかりやすくしたい。」
4. 「QuadrantChartで次のエラー　Lexical error on line 3. Unrecognized text. ...ities x-axis Low -> High y-axis Urge ----------------------^」
5. 「npm run devしたときにctrl+c押しても終了しないんだけどなぜ？」
6. 「Quadrant Chartでのみ次のエラーが出ています。 "Lexical error on line 3. Unrecognized text. ...ities x-axis Low -> High y-axis Urge ----------------------^"」
7. 「教材テキストを区切る縦線と入力欄を区切る横線はマウスドラッグで大きさを変えられるようにしてほしい。入力欄が小さい場合がある。」
8. 「左の教材テキストと右上の入力欄はスクロール可能のままで、プレビュー欄はスクロール不可として画面内に全体が表示できるようにしてください。プレビュー欄をクリックするとsvgが拡大されてポップアップでプレビューされるようにしたい。」
9. 「ダークテーマにするとヘッダー部分が視覚的に見づらい。色合いを調整してください。」
10. 「右上のトピックプルダウンの内容を日本語にしてください。「Topic」も別の日本語名にしてください。」
11. 「CLIツールではなくなったのでREADME.mdが実装と異なる箇所があるので現状に合わせてください。」
12. 「ここまでのcodexでの作業ログを codex.log として詳細に記述してください。」
13. 「codex.logを日本語にして」
14. 「私がCodexに対して入力したプロンプトをすべてcodex.logに残したい」
15. 「入力欄に入力してる途中に勝手に改行される。図示するプログラムが動くタイミングでなにかイベントが起きているせい？」
